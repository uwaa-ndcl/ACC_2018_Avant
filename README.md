# Dynamics, Hover Configurations, and Rotor Failure Restabilization of a Morphing Quadrotor
This is the code for the paper
**Dynamics, Hover Configurations, and Rotor Failure Restabilization of a Morphing Quadrotor**
https://ieeexplore.ieee.org/document/8431628
*Trevor Avant, Unsik Lee, Brian Katona & Kristi Morgansen*
published at the *American Control Conference (ACC) 2018*

# dynamics (Section II)
To derive the dynamics, run
`mathematica/dynamics.nb`
This will output 3 text files: `M.txt`, `h.txt`, and `Q.txt`. The contents of these files are intended to be copied into the Matlab dynamics file `dx.m`. This has already been done, so it is not necessary to run the .nb file again. Additionally, running this file may take a long time.

# hover configurations (Section III)
Analysis of the hover configurations is contained in
`mathematica/equilibrium_math.nb`

# rotor failure restabilization (Section IV)

## system overview diagrams (Figures 1 & 2)
To generate the 2D and 3D system overview diagrams, run
`matlab/plot/plot_overview_diagrams.m`

## hover recovery simulation (Figures 3 & 4)
To run the hover recovery simulation, run
`matlab/hover_recovery.m`
After running this file, you can generate plots by running some of the commented lines in the `%% plots` code section:
* to make Figure 3, run `plot_snapshots(X,T,T_snapshots,const);`
* to make Figure 4, run `plot_x_u(T,X,U);`
* to make an animation, run `animate_quadrotor(T,X,const);`

## region of attraction (Figure 5)
Note: There is a small error in Fig. 5. Our choice of Euler angles has singularities at theta = +/- pi/2 (not phi = +/- pi/2), so the blue lines should be vertical.
To generate and plot the region of attraction, run
`matlab/region_of_attraction.m`
This may take awhile. As an alternative, you can go to the bottom of the file and load previous results by running the commented line: `load region_of_attraction_results.mat`. Then, you can generate the plot by manually running the remaining lines of `region_of_attraction.m`.

# extras

## propeller calculations
Calculation of the thrust and torque coefficients is explained in the file
`matlab/propeller_calculations/propeller_coefficients_calculation.m`

## arm motion animations
To generate animations of the motion of the arms, run
`matlab/plot/plot_arm_motions.m`
Different motions can be generated by changing the `mode` variable in this file.

## dynamics tests
To test dynamics of the quadrotor for different initial conditions and/or control laws, run
`matlab/test_dynamics.m`
